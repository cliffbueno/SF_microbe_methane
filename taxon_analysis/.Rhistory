variable == "SO4_mgL" |
variable == "NH4_mgL" |
variable == "NO3_mgL" |
variable == "PO4_mgL" |
variable == "pH" |
variable == "sed_per_C" |
variable == "sed_per_N" |
variable == "sed_CN")
ggplot(metaComb_long_shared, aes(Estuary, value)) +
geom_boxplot() +
facet_wrap(~ variable, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
pdf("InitialFigs/Comb_All_Biogeochem.pdf", width = 10, height = 10)
ggplot(metaComb_long, aes(Estuary, value)) +
geom_boxplot() +
facet_wrap(~ variable, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
dev.off()
# Methane relationships
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth() +
scale_color_viridis_d() +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth() +
scale_y_log10() +
scale_color_viridis_d() +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
theme_bw() +
theme(legend.position = "none")
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
# Show trends by estuary
pdf("InitialFigs/Comb_All_CH4_Salinity.pdf", width = 9, height = 4)
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
# Show trends by estuary
pdf("InitialFigs/Comb_All_CH4_Salinity.pdf", width = 9, height = 4)
dev.off()
# Show trends by estuary
pdf("InitialFigs/Comb_All_CH4_Salinity.pdf", width = 9, height = 4)
pdf("InitialFigs/Comb_All_CH4.pdf", width = 7, height = 5)
dev.off()
#### Setup ####
suppressMessages(library(dplyr))
suppressMessages(library(rlang))
suppressMessages(library(tibble))
library(mctoolsr)
library(pheatmap)
library(RColorBrewer)
setwd("~/Documents/GitHub/SF_microbe_methane/taxon_analysis/")
setwd("~/Documents/GitHub/SF_microbe_methane/taxon_analysis/")
# Data Imports From Wyatt
# Import OTU Table
SilvaOTUs <- read.table("../silvaOTUs/Silva_OTU_VSTcpm.txt", sep='\t')
row.names(SilvaOTUs) <- SilvaOTUs[,"OTU"]
SilvaOTUs <- SilvaOTUs[,-1]
otu_V <- SilvaOTUs
# Sort OTU table
otu_V <- otu_V[order(otu_V$Consensus.lineage),]
# Make new top level plotting var (should be in PRE-PROCESS ? )
otu_V$Taxonomy <- ifelse(otu_V$Phylum == "Proteobacteria", paste(otu_V$Class), paste(otu_V$Phylum))
otu_V <- data.frame(otu_V)
# METADATA
metaDB <-read.table("../data/meta/SF_sal_meta_FIX3.txt", sep="\t", header=TRUE)
# Prune metadata to only iTag samples
# Get Sample names in OTU table
OTU_samps <- data.frame('Sample'=colnames(otu_V))
# Get aggregated guild counts by sample
guilds <- read.table("../guild_analysis/Silva_OTU_Guild_abundT_counts.txt", sep = "\t") %>%
select(1:17) %>%
rownames_to_column(var = "Sample")
# Merge site order and Samples,  log transform, merge guilds
Meta_iTag <- merge(metaDB, OTU_samps, by='Sample') %>%
select(Sample, Location, SALTgroup, CH4_ug_m2_h, SO4, Salinity.x, CO2_mg_m2_h) %>%
column_to_rownames(var = "Sample") %>%
mutate(Sample = rownames(.)) %>%
mutate(Salinity = log10(Salinity.x),
SO4 = log10(SO4),
CH4_ug_m2_h = log10(CH4_ug_m2_h - (1.05*min(CH4_ug_m2_h))),
CO2_mg_m2_h = log10(CO2_mg_m2_h)) %>%
select(Sample, Location, SALTgroup, Salinity, SO4, CH4_ug_m2_h, CO2_mg_m2_h) %>%
left_join(., guilds, by = "Sample")
View(Meta_iTag)
# Merge site order and Samples,  log transform, merge guilds
Meta_iTag <- merge(metaDB, OTU_samps, by='Sample') %>%
select(Sample, Location, SALTgroup, CH4_ug_m2_h, SO4, Salinity.x, CO2_mg_m2_h) %>%
column_to_rownames(var = "Sample") %>%
mutate(Sample = rownames(.)) %>%
mutate(Salinity = log10(Salinity.x),
SO4 = log10(SO4),
CH4_ug_m2_h = log10(CH4_ug_m2_h - (1.05*min(CH4_ug_m2_h))),
CO2_mg_m2_h = log10(CO2_mg_m2_h)) %>%
select(Sample, Location, SALTgroup, Salinity, SO4, CH4_ug_m2_h, CO2_mg_m2_h,
CH4_mix, CH4_me, everything()) %>%
left_join(., guilds, by = "Sample")
# Merge site order and Samples,  log transform, merge guilds
Meta_iTag <- merge(metaDB, OTU_samps, by='Sample') %>%
select(Sample, Location, SALTgroup, CH4_ug_m2_h, SO4, Salinity.x, CO2_mg_m2_h) %>%
column_to_rownames(var = "Sample") %>%
mutate(Sample = rownames(.)) %>%
mutate(Salinity = log10(Salinity.x),
SO4 = log10(SO4),
CH4_ug_m2_h = log10(CH4_ug_m2_h - (1.05*min(CH4_ug_m2_h))),
CO2_mg_m2_h = log10(CO2_mg_m2_h)) %>%
left_join(., guilds, by = "Sample") %>%
select(Sample, Location, SALTgroup, Salinity, SO4, CH4_ug_m2_h, CO2_mg_m2_h,
CH4_mix, CH4_me, everything())
View(Meta_iTag)
# Merge site order and Samples,  log transform, merge guilds
Meta_iTag <- merge(metaDB, OTU_samps, by='Sample') %>%
select(Sample, Location, SALTgroup, CH4_ug_m2_h, SO4, Salinity.x, CO2_mg_m2_h) %>%
column_to_rownames(var = "Sample") %>%
mutate(Sample = rownames(.)) %>%
mutate(Salinity = log10(Salinity.x),
SO4 = log10(SO4),
CH4_ug_m2_h = log10(CH4_ug_m2_h - (1.05*min(CH4_ug_m2_h))),
CO2_mg_m2_h = log10(CO2_mg_m2_h)) %>%
left_join(., guilds, by = "Sample") %>%
select(-Salinity.x, Sample, Location, SALTgroup, Salinity, SO4, CH4_ug_m2_h, CO2_mg_m2_h,
CH4_mix, CH4_me, everything())
View(Meta_iTag)
# Merge site order and Samples,  log transform, merge guilds
Meta_iTag <- merge(metaDB, OTU_samps, by='Sample') %>%
select(Sample, Location, SALTgroup, CH4_ug_m2_h, SO4, Salinity.x, CO2_mg_m2_h) %>%
column_to_rownames(var = "Sample") %>%
mutate(Sample = rownames(.)) %>%
mutate(Salinity = log10(Salinity.x),
SO4 = log10(SO4),
CH4_ug_m2_h = log10(CH4_ug_m2_h - (1.05*min(CH4_ug_m2_h))),
CO2_mg_m2_h = log10(CO2_mg_m2_h)) %>%
left_join(., guilds, by = "Sample") %>%
select(-Salinity.x) %>%
select(Sample, Location, SALTgroup, Salinity, SO4, CH4_ug_m2_h, CO2_mg_m2_h,
CH4_mix, CH4_me, everything())
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
dplyr::select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
arrange(-Index)
View(Guild_cols)
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
dplyr::select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
add_row(Guild = "CO2_mg_m2_h", Index = 18, color = "white") %>%
add_row(Guild = "CH4_ug_m2_h", Index = 19, color = "white") %>%
add_row(Guild = "SO4", Index = 20, color = "white") %>%
add_row(Guild = "Salinity", Index = 21, color = "white") %>%
arrange(-Index)
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
add_row(Guild = "CO2_mg_m2_h", Index = 18, color = "white") %>%
add_row(Guild = "CH4_ug_m2_h", Index = 19, color = "white") %>%
add_row(Guild = "SO4", Index = 20, color = "white") %>%
add_row(Guild = "Salinity", Index = 21, color = "white") %>%
arrange(-Index) %>%
filter(Guild != "MeOB")
# Cor matrix
vars <- Meta_iTag %>%
select(4:24)
View(vars)
`%notin%` <- Negate(`%in%`)
names(vars) %notin% Guild_cols$Guild
View(Guild_cols)
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
add_row(Guild = "CO2_mg_m2_h", Index = 18, color = "white") %>%
add_row(Guild = "CH4_ug_m2_h", Index = 19, color = "white") %>%
add_row(Guild = "SO4", Index = 20, color = "white") %>%
add_row(Guild = "Salinity", Index = 21, color = "white") %>%
arrange(-Index) %>%
filter(Guild != "MeOB") %>%
filter(Guild != "ANME")
names(vars) %notin% Guild_cols$Guild
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
add_row(Guild = "CO2_mg_m2_h", Index = 18, color = "white") %>%
add_row(Guild = "CH4_ug_m2_h", Index = 19, color = "white") %>%
add_row(Guild = "SO4", Index = 20, color = "white") %>%
add_row(Guild = "Salinity", Index = 21, color = "white") %>%
arrange(-Index) %>%
filter(Guild != "MeOB")
View(Guild_cols)
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t')
View(Guild_cols)
View(guilds)
# Get colors for colorbar. Note will need to make the env. vars white
Guild_cols <- read.table("../data/colors/Guild_color_palette.txt", sep='\t') %>%
select(Guild, G_index, color) %>%
set_names(c("Guild", "Index", "color")) %>%
mutate(Index = rev(Index)) %>%
add_row(Guild = "CH4_me", Index = 16, color = "#FDC086") %>%
add_row(Guild = "CH4_mix", Index = 17, color = "#FFFF99") %>%
add_row(Guild = "CO2_mg_m2_h", Index = 18, color = "white") %>%
add_row(Guild = "CH4_ug_m2_h", Index = 19, color = "white") %>%
add_row(Guild = "SO4", Index = 20, color = "white") %>%
add_row(Guild = "Salinity", Index = 21, color = "white") %>%
arrange(-Index) %>%
mutate(Guild = gsub("MeOB", "ANME", Guild))
View(Guild_cols)
names(vars) %notin% Guild_cols$Guild
names(vars) == Guild_cols$Guild
ann_rows <- data.frame(row.names = rownames(var),
"" = Guild_cols$Guild)
ann_rows <- data.frame(row.names = rownames(var),
"." = Guild_cols$Guild)
ann_rows <- data.frame(row.names = rownames(var),
"colorbar" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(var),
"colorbar" = Guild_cols$Guild)
ann_colors <- list(colorbar = Guild_cols$color)
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
ann_rows <- data.frame(row.names = rownames(var),
"colorbar" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(var),
"colorbar" = Guild_cols$Guild)
ann_colors <- list("colorbar" = Guild_cols$color)
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
ann_colors <- list("colorbar.r" = Guild_cols$color,
"colorbar.c" = Guild_cols$color)
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
ann_rows <- data.frame(row.names = rownames(var),
"colorbar.r" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(var),
"colorbar.c" = Guild_cols$Guild)
ann_colors <- list("colorbar.r" = Guild_cols$color,
"colorbar.c" = Guild_cols$color)
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
View(ann_rows)
cm <- cor(vars)
View(cm)
mycolors <- colorRampPalette(brewer.pal(11, "RdBu"))(100)
ann_rows <- data.frame(row.names = rownames(cm),
"colorbar.r" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(cm),
"colorbar.c" = Guild_cols$Guild)
ann_colors <- list("colorbar.r" = Guild_cols$color,
"colorbar.c" = Guild_cols$color)
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
names(vars) == Guild_cols$Guild
View(ann_cols)
ann_rows <- data.frame(row.names = rownames(cm),
"colorbar.r" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(cm),
"colorbar.c" = Guild_cols$Guild)
ann_colors <- list("colorbar.r" = c(ann_cols$colorbar.r[1] = Guild_cols$color[1],
ann_colors <- list("colorbar.r" = c(ann_rows$colorbar.r[1] = Guild_cols$color[1],
ann_colors <- list(colorbar.r = c(ann_rows$colorbar.r[1] = Guild_cols$color[1],
ann_rows$colorbar.r[1]
View(ann_colors)
View(ann_colors)
Guild_cols$color[1]
rm(ann_colors)
ann_colors <- list(colorbar.r = c(ann_rows$colorbar.r[1] = Guild_cols$color[1],
ann_colors <- list(colorbar.r = c(Slinity = Guild_cols$color[1],
ann_rows$colorbar.r[2] = Guild_cols$color[2],
ann_colors <- list(colorbar.r = c(Salinity = Guild_cols$color[1],
ann_rows$colorbar.r[2] = Guild_cols$color[2],
ann_cols$colorbar.c
ann_colors <- list(colorbar.r = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]),
colorbar.c = c(ann_cols$colorbar.c[1] = Guild_cols$color[1],
ann_colors <- list(colorbar.r = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]),
colorbar.c = c(ann_cols$colorbar.c[1] = Guild_cols$color[1],
ann_cols$colorbar.c
ann_colors <- list(colorbar.r = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]),
colorbar.c = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]))
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
names(vars) == Guild_cols$Guild
cm <- cor(vars)
mycolors <- colorRampPalette(brewer.pal(11, "RdBu"))(100)
ann_rows <- data.frame(row.names = rownames(cm),
"colorbar.r" = Guild_cols$Guild)
ann_cols <- data.frame(row.names = rownames(cm),
"colorbar.c" = Guild_cols$Guild)
ann_colors <- list(colorbar.r = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]),
colorbar.c = c(Salinity = Guild_cols$color[1],
SO4 = Guild_cols$color[2],
CH4_ug_m2_h = Guild_cols$color[3],
CO2_mg_m2_h = Guild_cols$color[4],
CH4_mix = Guild_cols$color[5],
CH4_me = Guild_cols$color[6],
CH4_H2 = Guild_cols$color[7],
CH4_ac = Guild_cols$color[8],
MOB_I = Guild_cols$color[9],
MOB_II = Guild_cols$color[10],
MOB_IIa = Guild_cols$color[11],
ANME = Guild_cols$color[12],
AOA = Guild_cols$color[13],
AOB = Guild_cols$color[14],
NOB = Guild_cols$color[15],
Anamx = Guild_cols$color[16],
SOxB = Guild_cols$color[17],
SRB_syn = Guild_cols$color[18],
SRB = Guild_cols$color[19],
FeOB = Guild_cols$color[20],
FeRB = Guild_cols$color[21]))
pheatmap(cm,
color = mycolors,
cluster_cols = F,
cluster_rows = F,
angle_col = 90,
border_color = NA,
annotation_row = ann_rows,
annotation_col = ann_cols,
annotation_colors = ann_colors)
pheatmap(cm)
View(cm)
